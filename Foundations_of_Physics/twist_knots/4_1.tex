\documentclass[tikz, border=10pt]{standalone}
\usepackage{tikz}
\usetikzlibrary{knots, hobby, calc, intersections, decorations.pathreplacing, decorations.markings, shapes.geometric, spath3}

% ==============================================================================
%  SST RENDER ENGINE: Twisted Dual-Strand Logic
% ==============================================================================

% -- Configuration --
\def\Wth{2.5pt}          % Strand width
\def\Core{white}         % Gap color (background color)
\def\Mask{5.0pt}         % Mask width for overlap
\def\ClrA{black!60!black}      % Strand A Color (Shadow)
\def\ClrB{red!70!black}  % Strand B Color (Main)
\def\Samples{400}        % Resolution

% -- Strand Style --
\tikzset{
    fat strand/.style={
        draw=#1, line width=\Wth,
        double=\Core, double distance=1.2*\Wth,
        line cap=round, line join=round
    }
}

% -- Coordinate Generator --
% #1: Path Definition, #2: Samples, #3: Amp, #4: Turns, #5: StrandName(A/B)
\newcommand{\MakeStrandCoords}[5]{%
    \pgfmathtruncatemacro{\Ns}{#2}
    \def\Phase{0}\ifx#5B\def\Phase{0.5}\fi
    \foreach \i in {0,...,\Ns}{%
        \pgfmathsetmacro{\s}{\i/\Ns}%
        \pgfmathsetmacro{\y}{#3*sin(360*(#4*\s + \Phase))}%
        \path[postaction={decorate, decoration={markings,
        mark=at position \s with {\coordinate (#5\i) at (0,\y);}}}] #1;%
    }%
}

% -- Segment Drawer --
\newcommand{\drawSeg}[4]{% #1:Name, #2:Index, #3:Color, #4:Over(0/1)
    \ifnum#4=1
    \draw[preaction={draw=\Core, line width=\Mask}, fat strand=#3]
    (#1#2) .. (#1\the\numexpr#2+1\relax);
    \else
        \draw[fat strand=#3]
        (#1#2) .. (#1\the\numexpr#2+1\relax);
    \fi
}

% -- Main Render Command --
% #1: Path Macro (e.g., \KPATH), #2: Turns, #3: Amplitude
\newcommand{\RenderTwist}[3]{
    \MakeStrandCoords{#1}{\Samples}{#3}{#2}{A}
    \MakeStrandCoords{#1}{\Samples}{#3}{#2}{B}
    \pgfmathtruncatemacro{\Last}{\Samples-1}
    \foreach \k in {0,...,\Last}{
        \pgfmathsetmacro{\s}{\k/\Samples}
        % Twist logic: swaps A/B depth based on sine phase
        \pgfmathtruncatemacro{\blk}{floor(2*#2*\s + 0.5)}
        \ifodd\blk
        \drawSeg{A}{\k}{\ClrA}{0}
        \drawSeg{B}{\k}{\ClrB}{1}
        \else
            \drawSeg{B}{\k}{\ClrB}{0}
            \drawSeg{A}{\k}{\ClrA}{1}
        \fi
    }
}

% -- Debug/Guide Points (Optional) --
\newcommand{\SSTGuidesPoints}[2]{
    \foreach \i in {1,...,#2}{
        \fill[blue] (P\i) circle (1.5pt);
        \node[blue,font=\tiny,above right] at (P\i) {\i};
    }
}

\begin{document}
    \begin{tikzpicture}[use Hobby shortcut, line cap=round, line join=round, scale=1.05]

% ---- controls ----
        \def\Amp{0.13}
        \def\Turns{4}        % can be non-integer; extrema logic still works
        \def\Samples{400}
        \def\Wth{2.5pt}
        \def\Core{black}     % set to page color for clean masking
        \def\Mask{5.0pt}
        \def\ClrA{black!60!black}
        \def\ClrB{red!70!black}

        \tikzset{
            fat strand/.style={
                draw=#1, line width=\Wth,
                double=\Core, double distance=1.2*\Wth
            }
        }

% ---- coordinates ----
        \coordinate (P1) at (-2.0,-2.0);
        \coordinate (P2) at (-2.0, 2.0);
        \coordinate (P3) at ( 1.0,-0.5);
        \coordinate (P4) at (-1.0,-0.5);
        \coordinate (P5) at ( 2.0, 2.0);
        \coordinate (P6) at ( 2.0,-2.0);
        \coordinate (P7) at (-1.0, 0.5);
        \coordinate (P8) at ( 1.0, 0.5);
        \coordinate (P9) at (-2.0,-2.0); % = P1
        \def\KPATH{([closed] P1)..(P2)..(P3)..(P4)..(P5)..(P6)..(P7)..(P8)..(P9)}


% ---- swap at offset extrema (least visible) ----
        \pgfmathtruncatemacro{\Last}{\Samples-1}
        \foreach \k in {0,...,\Last}{
            \pgfmathsetmacro{\s}{\k/\Samples}
            % block index changes at s = (1/4 + n/2)/Turns  <=> when 2*Turns*s crosses half-integers
            \pgfmathtruncatemacro{\blk}{floor(2*\Turns*\s + 0.5)}
            \ifodd\blk
            % B over, A under
            \drawSeg{A}{\k}{\ClrA}{0}
            \drawSeg{B}{\k}{\ClrB}{1}
            \else
            % A over, B under
                \drawSeg{B}{\k}{\ClrB}{0}
                \drawSeg{A}{\k}{\ClrA}{1}
            \fi
        }

    \end{tikzpicture}
\end{document}